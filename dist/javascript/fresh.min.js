function initSnowCanvas(a){function b(c,d,e){function f(){k.clearRect(0,0,c.width,c.height);for(var a=0;l>a;a++){var b=j[a],d=m,e=n,h=100,o=b.x,p=b.y,q=Math.sqrt((o-d)*(o-d)+(p-e)*(p-e));if(h>q){var r=h/(q*q),s=(d-o)/q,t=(e-p)/q,u=r/2;b.velX-=u*s,b.velY-=u*t}else switch(b.velX*=.98,b.velY<=b.speed&&(b.velY=b.speed),i.windPower){case!1:b.velX+=Math.cos(b.step+=.05)*b.stepSize;break;case 0:b.velX+=Math.cos(b.step+=.05)*b.stepSize;break;default:b.velX+=.01+i.windPower/100}var v=i.color,w=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/,x=w.exec(v),y=parseInt(x[1],16)+","+parseInt(x[2],16)+","+parseInt(x[3],16);b.y+=b.velY,b.x+=b.velX,(b.y>=c.height||b.y<=0)&&g(b),(b.x>=c.width||b.x<=0)&&g(b),i.image===!1&&(k.fillStyle="rgba("+y+","+b.opacity+")",k.beginPath(),k.arc(b.x,b.y,b.size,0,2*Math.PI),k.fill())}requestAnimationFrame(f)}function g(a){if(i.windPower===!1||0===i.windPower)a.x=Math.floor(Math.random()*c.width),a.y=0;else{var b,d,e,f;i.windPower>0?(b=Array(Math.floor(Math.random()*c.width),0),d=Array(0,Math.floor(Math.random()*c.height)),e=Array(b,d),f=e[Math.floor(Math.random()*e.length)],a.x=f[0],a.y=f[1]):(b=Array(Math.floor(Math.random()*c.width),0),d=Array(c.width,Math.floor(Math.random()*c.height)),e=Array(b,d),f=e[Math.floor(Math.random()*e.length)],a.x=f[0],a.y=f[1])}a.size=3*Math.random()+i.size,a.speed=1*Math.random()+i.speed,a.velY=a.speed,a.velX=0,a.opacity=.5*Math.random()+i.opacity}function h(){for(var a=0;l>a;a++){var b=Math.floor(Math.random()*c.width),d=Math.floor(Math.random()*c.height),e=3*Math.random()+i.size,g=1*Math.random()+i.speed,h=.5*Math.random()+i.opacity;j.push({speed:g,velY:g,velX:0,x:b,y:d,size:e,stepSize:Math.random()/30,step:0,angle:180,opacity:h})}f()}var i=d,j=[],k=c.getContext("2d"),l=i.count,m=-100,n=-100;if(c.width=a.innerWidth,c.height=a.innerHeight,e!==!0&&!function(){var b=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)};a.requestAnimationFrame=b}(),h(),e!==!0){var o=null;a.addEventListener("resize",function(a){o&&clearTimeout(o),o=setTimeout(function(){b(c,i,!0)},200)})}e!==!0&&i.interaction===!0&&c.addEventListener("mousemove",function(a){m=a.clientX,n=a.clientY})}var c=document.getElementById("snow-canvas");b(c,{speed:0,interaction:!0,size:2,count:200,opacity:0,color:"#ffffff",windPower:0,image:!1})}function initWinterJam2015(a){function b(){var b=new Date,c=null;if("jam"===q&&(c=Math.floor(r-b),0>c&&(q="vote",$(".join-jam-button").css("display","none"),$(".vote-button").css("display","block"),$(".jam-time-remaining-label").text("Voting time remaining:"),$(".time-remaining").addClass("voting"))),"vote"===q&&(c=Math.floor(s-b),0>c&&(q="end",$(".vote-button").css("display","none"),l.html("<h1>THE JAM HAS ENDED, SEE YOU IN JUNE!</h1>"),l.addClass("ended"),a.clearInterval(t))),null!==c){var d=c/1e3|0;c-=1e3*d;var e=d/60|0;d-=60*e;var f=e/60|0;e-=60*f;var g=f/24|0,h=f-24*g;m.text(g),n.text(h),o.text(e),p.text(d)}}function c(a,b){var c="000000000"+a;return c.substr(c.length-b)}function d(a){var b=$('<tr><td class="jam-participant-name">'+a+'</td><td class="jam-participant-time"></td><td class="jam-participant-action"></td></tr>'),c=$("<button>Upload</button>").click(function(){x=a,h($(".upload-modal"))});return b.find(".jam-participant-action").append(c),b}function e(){if(w){var a=new Date;v.find("tbody").find("tr").each(function(b){if(!$(this).hasClass("jam-time-over")){var d=Math.floor(w[b].endDate-a);if(d>0){var e=d/1e3|0;d-=1e3*e;var f=e/60|0;e-=60*f;var h=f/60|0;f-=60*h,$(this).find("td.jam-participant-time").text(c(h,2)+":"+c(f,2)+":"+c(e,2))}else $(this).addClass("jam-time-over"),$(this).find("td.jam-participant-time").text("00:00:00"),$(this).find("td.jam-participant-action").children().first().replaceWith($("<button>Download</button>").click(function(){g(w[b].name)}))}})}}function f(){$(".modal").each(function(b){var c=$(this);if("none"!==c.css("display")){var d=c.find(".modal-content");a.innerHeight-d.height()>500?d.css("top",a.innerHeight/3-d.height()/2):d.css("top",a.innerHeight/2-d.height()/2),d.css("left",a.innerWidth/2-d.width()/2)}})}function g(b){a.location.href="/api/winter-jam-2015/users/"+b+"/submission"}function h(a){a.fadeIn(400),f(a)}function i(a){a.fadeOut(400)}function j(a,b){return function(c){k(c).success(a).fail(b)}}function k(a){a.preventDefault();var b=$(a.target),c=b.serializeArray().reduce(function(a,b){return a[b.name]=b.value,a},{});return $.ajax({type:b.attr("method"),url:b.attr("action"),contentType:"application/json",dataType:"json",data:JSON.stringify(c)})}var l=$("#jam-time-remaining"),m=l.find(".jam-days"),n=l.find(".jam-hours"),o=l.find(".jam-minutes"),p=l.find(".jam-seconds"),q="jam",r=new Date("2016-01-18T00:00:00.0-07:00"),s=new Date("2016-02-00T00:00:00.0-07:00");b();var t=setInterval(b,1e3),u=864e5,v=$(".jam-participants-table"),w=null,x=null;$.ajax({type:"GET",url:"/api/winter-jam-2015/users"}).success(function(a,b){w=a.map(function(a){return a.beginDate=new Date(a.beginDate),a.endDate=new Date(a.beginDate),a.endDate.setTime(a.beginDate.getTime()+u),a}),a.forEach(function(a){v.find("tbody:last-child").append(d(a.name))}),e(),setInterval(e,1e3)}).fail(function(a){$("#participants-error-message").text("Error: "+a.responseText)}),$(".join-jam-button").click(function(){h($(".join-jam-modal"))}),$(".modal").click(function(a){this===a.target&&i($(this))}),$(a).resize(f);var y=$(".join-jam-form"),z=y.find(".error-message");y.submit(j(function(a,b){var c={name:a.name,beginDate:new Date};c.endDate=new Date(c.beginDate),c.endDate.setTime(c.beginDate.getTime()+u),w.unshift(c),v.find("tbody").prepend(d(c.name));var e=$(".join-jam-success");y.css("display","none"),e.find(".secret-code").text(a.secretCode),e.css("display","block"),f()},function(a){z.text("Error: "+a.responseText)}));var A=$(".upload-form"),B=A.find(".success-message"),C=A.find(".error-message");A.submit(function(a){a.preventDefault(),C.text(""),B.text("Uploading...");var b=new FormData(this);$.ajax({url:"/api/winter-jam-2015/users/"+x+"/submission",type:"POST",data:b,cache:!1,contentType:!1,processData:!1}).success(function(a,b){C.text(""),B.text("Upload successful!")}).fail(function(a){B.text(""),C.text("Error: "+a.responseText)})})}