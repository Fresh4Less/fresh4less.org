function initSnowCanvas(a){function b(c,d,e){function f(){k.clearRect(0,0,c.width,c.height);for(var a=0;l>a;a++){var b=j[a],d=m,e=n,h=100,o=b.x,p=b.y,q=Math.sqrt((o-d)*(o-d)+(p-e)*(p-e));if(h>q){var r=h/(q*q),s=(d-o)/q,t=(e-p)/q,u=r/2;b.velX-=u*s,b.velY-=u*t}else switch(b.velX*=.98,b.velY<=b.speed&&(b.velY=b.speed),i.windPower){case!1:b.velX+=Math.cos(b.step+=.05)*b.stepSize;break;case 0:b.velX+=Math.cos(b.step+=.05)*b.stepSize;break;default:b.velX+=.01+i.windPower/100}var v=i.color,w=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/,x=w.exec(v),y=parseInt(x[1],16)+","+parseInt(x[2],16)+","+parseInt(x[3],16);b.y+=b.velY,b.x+=b.velX,(b.y>=c.height||b.y<=0)&&g(b),(b.x>=c.width||b.x<=0)&&g(b),i.image===!1&&(k.fillStyle="rgba("+y+","+b.opacity+")",k.beginPath(),k.arc(b.x,b.y,b.size,0,2*Math.PI),k.fill())}requestAnimationFrame(f)}function g(a){if(i.windPower===!1||0===i.windPower)a.x=Math.floor(Math.random()*c.width),a.y=0;else{var b,d,e,f;i.windPower>0?(b=Array(Math.floor(Math.random()*c.width),0),d=Array(0,Math.floor(Math.random()*c.height)),e=Array(b,d),f=e[Math.floor(Math.random()*e.length)],a.x=f[0],a.y=f[1]):(b=Array(Math.floor(Math.random()*c.width),0),d=Array(c.width,Math.floor(Math.random()*c.height)),e=Array(b,d),f=e[Math.floor(Math.random()*e.length)],a.x=f[0],a.y=f[1])}a.size=3*Math.random()+i.size,a.speed=1*Math.random()+i.speed,a.velY=a.speed,a.velX=0,a.opacity=.5*Math.random()+i.opacity}function h(){for(var a=0;l>a;a++){var b=Math.floor(Math.random()*c.width),d=Math.floor(Math.random()*c.height),e=3*Math.random()+i.size,g=1*Math.random()+i.speed,h=.5*Math.random()+i.opacity;j.push({speed:g,velY:g,velX:0,x:b,y:d,size:e,stepSize:Math.random()/30,step:0,angle:180,opacity:h})}f()}var i=d,j=[],k=c.getContext("2d"),l=i.count,m=-100,n=-100;if(c.width=a.innerWidth,c.height=a.innerHeight,e!==!0&&!function(){var b=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)};a.requestAnimationFrame=b}(),h(),e!==!0){var o=null;a.addEventListener("resize",function(a){o&&clearTimeout(o),o=setTimeout(function(){b(c,i,!0)},200)})}e!==!0&&i.interaction===!0&&c.addEventListener("mousemove",function(a){m=a.clientX,n=a.clientY})}var c=document.getElementById("snow-canvas");b(c,{speed:0,interaction:!0,size:2,count:200,opacity:0,color:"#ffffff",windPower:0,image:!1})}function initWinterJam2015(a){function b(){var b=new Date,c=Math.floor(p-b);if(0>c)a.clearInterval(q),i.textContent="THE JAM HAS ENDED, SEE YOU IN JUNE!",i.className=i.className+" ended",$(".join-jam-button").css("display","none");else{var d=c/1e3|0;c-=1e3*d;var e=d/60|0;d-=60*e;var f=e/60|0;e-=60*f;var g=f/24|0,h=f-24*g;j.textContent=g,k.textContent=h,l.textContent=e,m.textContent=d}}function c(){if(s){var a=new Date;r.find("tbody").find("tr").each(function(b){if(!$(this).hasClass("jam-time-over")){var c=Math.floor(s[b].endDate-a);if(c>0){var d=c/1e3|0;c-=1e3*d;var e=d/60|0;d-=60*e;var f=e/60|0;e-=60*f,$(this).find("td.jam-participant-time").text(f+":"+e+":"+d)}else $(this).addClass("jam-time-over"),$(this).find("td.jam-participant-time").text("00:00:00"),$(this).find("td.jam-participant-action").html("<button>Download</button>")}})}}function d(){$(".modal").each(function(b){var c=$(this);if("none"!==c.css("display")){var d=c.find(".modal-content");a.innerHeight-d.height()>500?d.css("top",a.innerHeight/3-d.height()/2):d.css("top",a.innerHeight/2-d.height()/2),d.css("left",a.innerWidth/2-d.width()/2)}})}function e(a){a.css("display","block"),d(a)}function f(a){a.css("display","none")}function g(a,b){return function(c){h(c).success(a).fail(b)}}function h(a){a.preventDefault();var b=$(a.target),c=b.serializeArray().reduce(function(a,b){return a[b.name]=b.value,a},{});return $.ajax({type:b.attr("method"),url:b.attr("action"),contentType:"application/json",dataType:"json",data:JSON.stringify(c)})}for(var i=a.document.getElementById("jam-time-remaining"),j=null,k=null,l=null,m=null,n=0;n<i.childNodes.length;n++){var o=i.childNodes[n];switch(o.className){case"jam-days":j=o;break;case"jam-hours":k=o;break;case"jam-minutes":l=o;break;case"jam-seconds":m=o}}var p=new Date("2016-01-01T00:00:00.0-07:00");b();var q=setInterval(b,1e3),r=$(".jam-participants-table"),s=null,t=null;$.ajax({type:"GET",url:"/api/winter-jam-2015/users"}).success(function(a,b){s=a.map(function(a){return a.beginDate=new Date(a.beginDate),a.endDate=new Date(a.beginDate),a.endDate.setTime(a.beginDate.getTime()+864e5),a}),a.forEach(function(a){r.find("tbody:last-child").append($('<tr><td class="jam-participant-name">'+a.name+'</td><td class="jam-participant-time"></td><td class="jam-participant-action"><button>Upload</button></td></tr>').click(function(){t=a.name,e($(".upload-modal"))}))}),c(),setInterval(c,100)}).fail(function(a){$("#participants-error-message").text(a.responseText)}),$(".join-jam-button").click(function(){e($(".join-jam-modal"))}),$(".modal").click(function(a){this===a.target&&f($(this))}),$(a).resize(d);var u=$(".join-jam-form"),v=u.find(".error-message");u.submit(g(function(a,b){var c=$(".join-jam-success");u.css("display","none"),c.find(".secret-code").text(a.secretCode),c.css("display","block"),d()},function(a){v.text(a.responseText)}));var w=$(".upload-form"),x=w.find(".success-message"),y=w.find(".error-message");w.submit(function(a){a.preventDefault();var b=new FormData(this);$.ajax({url:"/api/winter-jam-2015/users/"+t+"/submission",type:"POST",data:b,cache:!1,contentType:!1,processData:!1}).success(function(a,b){y.text(""),x.text("Upload successful!")}).fail(function(a){x.text(""),y.text(a.responseText)})})}